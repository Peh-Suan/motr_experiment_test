{"remainingRequest":"/Users/pohsuan/motr_experiment_test/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/pohsuan/motr_experiment_test/node_modules/magpie-base/src/components/screens/SubmitResultsScreen.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/pohsuan/motr_experiment_test/node_modules/magpie-base/src/components/screens/SubmitResultsScreen.vue","mtime":1770092180478},{"path":"/Users/pohsuan/motr_experiment_test/node_modules/cache-loader/dist/cjs.js","mtime":1770073233767},{"path":"/Users/pohsuan/motr_experiment_test/node_modules/vue-loader/lib/index.js","mtime":1770073233695}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBTY3JlZW4gZnJvbSAnLi4vU2NyZWVuJzsKaW1wb3J0IFdhaXQgZnJvbSAnLi4vaGVscGVycy9XYWl0JzsKaW1wb3J0IERlYnVnUmVzdWx0c1NjcmVlbiBmcm9tICcuL0RlYnVnUmVzdWx0c1NjcmVlbic7CmltcG9ydCBTbGlkZSBmcm9tICcuLi9TbGlkZSc7CmltcG9ydCBzdHJpbmdpZnkgZnJvbSAnY3N2LXN0cmluZ2lmeS9saWIvc3luYyc7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1N1Ym1pdFJlc3VsdHNTY3JlZW4nLAogIGNvbXBvbmVudHM6IHsgU2xpZGUsIERlYnVnUmVzdWx0c1NjcmVlbiwgV2FpdCwgU2NyZWVuIH0sCiAgcHJvcHM6IHt9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBlcnJvcjogbnVsbCwKICAgICAgcmVzdWx0czogW10sCiAgICAgIGNzdjogJycKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBzdWJtaXQoY2IpIHsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCB0aGlzLiRtYWdwaWUuc3VibWl0KCk7CiAgICAgICAgY2IoKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpcy5yZXN1bHRzID0gdGhpcy4kbWFncGllLmdldEFsbERhdGEoKTsKICAgICAgICBpZiAodGhpcy5yZXN1bHRzLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5jc3YgPSBzdHJpbmdpZnkodGhpcy5yZXN1bHRzLCB7CiAgICAgICAgICAgIGNvbHVtbnM6IE9iamVjdC5rZXlzKHRoaXMucmVzdWx0c1swXSksCiAgICAgICAgICAgIGhlYWRlcjogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHRoaXMuZXJyb3IgPSBlcnIubWVzc2FnZTsKICAgICAgICBjYigpOwogICAgICB9CiAgICB9LAogICAgcmVkaXJlY3RUb0NvbXBsZXRpb25VcmwoKSB7CiAgICAgIGlmICh0aGlzLiRtYWdwaWUuY29tcGxldGlvblVybCAmJiB0aGlzLiRtYWdwaWUubW9kZSA9PT0gJ3Byb2xpZmljJykgewogICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IHRoaXMuJG1hZ3BpZS5jb21wbGV0aW9uVXJsOwogICAgICB9CiAgICB9LAogICAgZG93bmxvYWRDc3YoKSB7CiAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbdGhpcy5jc3ZdLCB7CiAgICAgICAgdHlwZTogJ3RleHQvcGxhaW4nLAogICAgICAgIGVuZGluZ3M6ICduYXRpdmUnCiAgICAgIH0pOwogICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICBjb25zdCBmaWxlbmFtZSA9CiAgICAgICAgJ2RhdGEtJyArCiAgICAgICAgdGhpcy4kbWFncGllLmlkICsKICAgICAgICAnLScgKwogICAgICAgIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zbGljZSgwLCAxNikucmVwbGFjZSgvWzpUXS9nLCAnLScpICsKICAgICAgICAnLmNzdic7CiAgICAgIGNvbnN0IG9iamVjdFVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdocmVmJywgb2JqZWN0VXJsKTsKICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZmlsZW5hbWUpOwogICAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7CiAgICAgIGVsZW1lbnQuY2xpY2soKTsKICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChvYmplY3RVcmwpOwogICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW1lbnQpOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["SubmitResultsScreen.vue"],"names":[],"mappings":";AA2CA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SubmitResultsScreen.vue","sourceRoot":"node_modules/magpie-base/src/components/screens","sourcesContent":["<docs>\n  Use this screen at the end of your experiment to submit the data to the server.\n  You can provide the submission URL to the Experiment component.\n</docs>\n\n<template>\n  <Screen v-if=\"!$magpie.debug\" title=\"Submitting\">\n    <Slide>\n      <p>{{ $t('screens.SubmitResultsScreen.waiting') }}</p>\n      <Wait :time=\"0\" @done=\"submit(() => $magpie.nextSlide())\" />\n    </Slide>\n    <Slide>\n      <p v-if=\"!error\">\n        {{ $t('screens.SubmitResultsScreen.done') }}\n        <Wait :time=\"3000\" @done=\"redirectToCompletionUrl\" />\n      </p>\n      <div v-else>\n        <p>{{ $t('screens.SubmitResultsScreen.error') }}</p>\n        <p>{{ $t('screens.SubmitResultsScreen.manual') }}</p>\n        <p>\n          {{ $t('screens.SubmitResultsScreen.contact') }}\n          <a :href=\"'mailto:' + $magpie.contactEmail\" target=\"_blank\" rel=\"noopener\">\n            {{ $magpie.contactEmail }}\n          </a>\n        </p>\n        <p v-text=\"\" />\n        <button style= \"bottom: 30%; transform: translate(-50%, -50%)\" @click=\"downloadCsv\">\n          {{ $t('screens.SubmitResultsScreen.download') }}\n        </button>\n        <p>\n          {{ $t('screens.SubmitResultsScreen.upload') }}\n          <a :href=\"$magpie.uploadUrl\" target=\"_blank\" rel=\"noopener\">\n            {{ $magpie.uploadUrl }}\n          </a>\n        </p>\n        <p>{{ $t('screens.SubmitResultsScreen.thanks') }}</p>\n      </div>\n    </Slide>\n  </Screen>\n  <DebugResultsScreen v-else />\n</template>\n\n<script>\nimport Screen from '../Screen';\nimport Wait from '../helpers/Wait';\nimport DebugResultsScreen from './DebugResultsScreen';\nimport Slide from '../Slide';\nimport stringify from 'csv-stringify/lib/sync';\n\nexport default {\n  name: 'SubmitResultsScreen',\n  components: { Slide, DebugResultsScreen, Wait, Screen },\n  props: {},\n  data() {\n    return {\n      error: null,\n      results: [],\n      csv: ''\n    };\n  },\n  methods: {\n    async submit(cb) {\n      try {\n        await this.$magpie.submit();\n        cb();\n      } catch (err) {\n        this.results = this.$magpie.getAllData();\n        if (this.results.length) {\n          this.csv = stringify(this.results, {\n            columns: Object.keys(this.results[0]),\n            header: true\n          });\n        }\n        this.error = err.message;\n        cb();\n      }\n    },\n    redirectToCompletionUrl() {\n      if (this.$magpie.completionUrl && this.$magpie.mode === 'prolific') {\n        window.location = this.$magpie.completionUrl;\n      }\n    },\n    downloadCsv() {\n      const blob = new Blob([this.csv], {\n        type: 'text/plain',\n        endings: 'native'\n      });\n      const element = document.createElement('a');\n      const filename =\n        'data-' +\n        this.$magpie.id +\n        '-' +\n        new Date().toISOString().slice(0, 16).replace(/[:T]/g, '-') +\n        '.csv';\n      const objectUrl = URL.createObjectURL(blob);\n      element.setAttribute('href', objectUrl);\n      element.setAttribute('download', filename);\n      element.style.display = 'none';\n      document.body.appendChild(element);\n      element.click();\n      URL.revokeObjectURL(objectUrl);\n      document.body.removeChild(element);\n    }\n  }\n};\n</script>\n"]}]}